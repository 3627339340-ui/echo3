<script>
  async function generateReply(text) {
    try {
      const response = await fetch("/api/generate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: text })
      });
      const data = await response.json();
      if (data.reply) return data.reply;
      else throw new Error("æœªè¿”å›å†…å®¹");
    } catch (err) {
      console.error(err);
      return "æœªæ¥çš„ä½ ä¸€å®šä¼šæ„Ÿè°¢æ­¤åˆ»åŠªåŠ›çš„è‡ªå·±ã€‚ğŸ’Œï¼ˆæ™ºèƒ½å›ä¿¡æš‚æ—¶ä¸å¯ç”¨ï¼‰";
    }
  }

  generateBtn.onclick = async () => {
    const val = document.getElementById('userInput').value.trim();
    if (!val) return alert('è¯·å…ˆå†™ä¸‹ä½ çš„å¿ƒå£°å“¦ ğŸ’Œ');
    replyText.textContent = "æ­£åœ¨ç”Ÿæˆæœªæ¥çš„å›ä¿¡ï¼Œè¯·ç¨å€™...";
    inputArea.style.display = 'none';
    letterBox.classList.add('show');

    const reply = await generateReply(val);
    replyText.textContent = reply;
  };
</script>
